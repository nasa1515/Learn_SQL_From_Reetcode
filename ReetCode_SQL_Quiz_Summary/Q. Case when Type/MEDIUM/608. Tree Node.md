## [608. Tree Node]


### Table: Tree


| Column Name | Type |
|-------------|------|
| id          | int  |
| p_id        | int  |

id is the column with unique values for this table.  
Each row of this table contains information about the id of a node and the id of its parent node in a tree.  
The given structure is always a valid tree.  
 
## Problem 

Each node in the tree can be one of three types:  

* "Leaf": if the node is a leaf node.
* "Root": if the node is the root of the tree.
* "Inner": If the node is neither a leaf node nor a root node.

Write a solution to report the type of each node in the tree.  
Return the result table in any order.  
The result format is in the following example.  



## Example 1:

![image](https://github.com/user-attachments/assets/1437694c-04ab-4298-9873-2f510923d546)


### Input: 

Tree table:


| id | p_id |
|----|------|
| 1  | null |
| 2  | 1    |
| 3  | 1    |
| 4  | 2    |
| 5  | 2    |

### Output: 

| id | type  |
|----|-------|
| 1  | Root  |
| 2  | Inner |
| 3  | Leaf  |
| 4  | Leaf  |
| 5  | Leaf  |

### Explanation: 

* Node 1 is the root node because its parent node is null and it has child nodes 2 and 3.
* Node 2 is an inner node because it has parent node 1 and child node 4 and 5.
* Nodes 3, 4, and 5 are leaf nodes because they have parent nodes and they do not have child nodes.

## Example 2:

![image](https://github.com/user-attachments/assets/3884fc59-2be5-46d5-a6ed-231b7067ffb3)

### Input: 

Tree table:


| id | p_id |
|----|------|
| 1  | null |

### Output: 

| id | type  |
|----|-------|
| 1  | Root  |

#### Explanation: 

* If there is only one node on the tree, you only need to output its root attributes.



<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
WITH TEMP AS (
    SELECT DISTINCT(p_id) AS ID
    FROM Tree
    WHERE p_id IS NOT NULL  
)

SELECT id, 
       CASE 
       WHEN p_id IS NULL THEN "Root" 
       WHEN p_id IS NOT NULL AND id IN (SELECT ID FROM TEMP) THEN "Inner" 
       ELSE "Leaf"
       END AS Type
FROM Tree
```

## ğŸŸ¢ í’€ì´ (Discription)
`CTE`ë¥¼ ì‚¬ìš©í•´ì„œ, `p_id` ì˜ ìœ ë‹ˆí¬ ê°’ì„ í•„í„°ë§ í•˜ê³ , `CASE WHEN`ìœ¼ë¡œ ê°ê° ë…¸ë“œì˜ typeì„ ì§‘ê³„í•´ í•´ê²°í–ˆìŠµë‹ˆë‹¤.   
ë¬¸ì œì—ì„œ ë‚˜ì˜¨ ì¡°ê±´ì— ë”°ë¼ì„œ, í’€ì´ë¥¼ ëŒ€ì‹ í•˜ê² ìŠµë‹ˆë‹¤. 

1. `p_id`ê°€ `NOT NULL` ì´ë©´ì„œ, `Distinct` í•œ ê²½ìš°ëŠ” `Root`ì™€ `Inner` ë‘ ê²½ìš° ë¿ì´ê¸°ì—, í•„í„°ë§í•˜ëŠ” `CTE`ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.  

### CTE ìƒì„± 

```sql
SELECT DISTINCT(p_id) AS ID
FROM Tree
WHERE p_id IS NOT NULL  
```

### CTE ìƒì„± ê²°ê³¼ `(ìœ ë‹ˆí¬í•œ ê°’ë“¤)`

| ID |
| -- |
| 1  |
| 2  |

2. ì´ì œ `case when`ìœ¼ë¡œ ê°ê° ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë¥¼ í•„í„°ë§ í•˜ë©´ ë©ë‹ˆë‹¤. 

* "P_id" ê°€ NULL ì¸ ê²½ìš° - "Root"
* "P_id" ê°€ NULLì´ ì•„ë‹Œë°, CTE ì•ˆì— í¬í•¨ë˜ì–´ ìˆëŠ” ê²½ìš° - Inner
* "P_id" ê°€ NULLì´ ì•„ë‹Œë°, CTE ì•ˆì— ì—†ëŠ” ê²½ìš° - Leaf

### case when ì¿¼ë¦¬

```sql
SELECT id, 
       CASE 
       WHEN p_id IS NULL THEN "Root" 
       WHEN p_id IS NOT NULL AND id IN (SELECT ID FROM TEMP) THEN "Inner" 
       ELSE "Leaf"
       END AS Type
FROM Tree
```