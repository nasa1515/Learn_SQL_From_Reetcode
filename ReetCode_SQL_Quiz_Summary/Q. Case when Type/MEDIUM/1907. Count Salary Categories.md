## [1907. Count Salary Categories]

### Table: Accounts


| Column Name | Type |
|-------------|------|
| account_id  | int  |
| income      | int  |

account_id is the primary key (column with unique values) for this table.  
Each row contains information about the monthly income for one bank account.  
 
## Problem 

Write a solution to calculate the number of bank accounts for each salary category.  

The salary categories are:  

"Low Salary": All the salaries strictly less than $20000.  
"Average Salary": All the salaries in the inclusive range [$20000, $50000].  
"High Salary": All the salaries strictly greater than $50000.   
The result table must contain all three categories. If there are no accounts in a category, return 0.  

Return the result table in any order.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Accounts table:


| account_id | income |
|------------|--------|
| 3          | 108939 |
| 2          | 12747  |
| 8          | 87709  |
| 6          | 91796  |

### Output: 

| category       | accounts_count |
|----------------|----------------|
| Low Salary     | 1              |
| Average Salary | 0              |
| High Salary    | 3              |

### Explanation: 

* Low Salary: Account 2.
* Average Salary: No accounts.
* High Salary: Accounts 3, 6, and 8.


<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
WITH TEMP AS (
    SELECT account_id,
        CASE WHEN income < 20000 THEN 1 ELSE 0 END AS Low_Salary_count,
        CASE WHEN income <= 50000 AND income >= 20000 THEN 1 ELSE 0 END AS Average_Salary_count,
        CASE WHEN income > 50000 THEN 1 ELSE 0 END AS High_Salary_count
    FROM Accounts)

SELECT "Low Salary" as category, SUM(Low_Salary_count) AS accounts_count FROM TEMP
UNION ALL
SELECT "Average Salary" as category, SUM(Average_Salary_count) AS accounts_count FROM TEMP
UNION ALL
SELECT "High Salary" as category, SUM(High_Salary_count) AS accounts_count FROM TEMP
```

## ğŸŸ¢ í’€ì´ (Discription)
`CTE`ë¥¼ ì‚¬ìš©í•´ì„œ ê° ì¡°ê±´ì— ë”°ë¥¸ ë°ì´í„° ê°’ë“¤ì„ ë¯¸ë¦¬ ê³„ì‚°í•´ë†“ê³ , í•´ë‹¹ ê²°ê³¼ë“¤ì„ `Union` í•´ì„œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ í•´ê²°í–ˆìŠµë‹ˆë‹¤.   
ë¬¸ì œì—ì„œ ë‚˜ì˜¨ ì¡°ê±´ì— ë”°ë¼ì„œ, í’€ì´ë¥¼ ëŒ€ì‹ í•˜ê² ìŠµë‹ˆë‹¤. 

ì´ë²ˆ ë¬¸ì œëŠ” ì™œ `MEDIUM` ë‚œì´ë„ì¸ì§€ ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤..? ê·¸ë˜ì„œ ë¬¸ì œ ì„¤ëª…ì€ ìµœëŒ€í•œ ê°„ë‹¨í•˜ê²Œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

#### `CTE` Case ì¡°ê±´ìœ¼ë¡œ `income`ì´ íŠ¹ì • ì¡°ê±´ ë³„ ë§ëŠ” ìƒí™©ì— ëŒ€í•œ, ì¶”ê°€ ì»¬ëŸ¼ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. 

| account_id | Low_Salary_count | Average_Salary_count | High_Salary_count |
| ---------- | ---------------- | -------------------- | ----------------- |
| 3          | 0                | 0                    | 1                 |
| 2          | 1                | 0                    | 0                 |
| 8          | 0                | 0                    | 1                 |
| 6          | 0                | 0                    | 1                 |...


#### `UNION ALL`ë¡œ íŠ¹ì • ë¬¸ìì—´ì„ ë„£ì€ ì»¬ëŸ¼ê³¼, ê³„ì‚° ê²°ê³¼ë¥¼ ì¶œë ¥ì„ í•©ì³ì„œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.  

```sql

SELECT "Low Salary" as category, SUM(Low_Salary_count) AS accounts_count FROM TEMP
UNION ALL
SELECT "Average Salary" as category, SUM(Average_Salary_count) AS accounts_count FROM TEMP
UNION ALL
SELECT "High Salary" as category, SUM(High_Salary_count) AS accounts_count FROM TEMP
```