## [1285. Find the Start and End Number of Continuous Ranges]  


### Table: Logs


| Column Name   | Type    |
|---------------|---------|
| log_id        | int     |

log_id is the column of unique values for this table.  
Each row of this table contains the ID in a log Table.  
 
## Problem 

Write a solution to find the start and end number of continuous ranges in the table Logs.  

Return the result table ordered by start_id.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Logs table:

| log_id     |
|------------|
| 1          |
| 2          |
| 3          |
| 7          |
| 8          |
| 10         |

### Output: 

| start_id   | end_id       |
|------------|--------------|
| 1          | 3            |
| 7          | 8            |
| 10         | 10           |

### Explanation: 

* The result table should contain all ranges in table Logs.
* From 1 to 3 is contained in the table.
* From 4 to 6 is missing in the table
* From 7 to 8 is contained in the table.
* Number 9 is missing from the table.
* Number 10 is contained in the table. 



<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
WITH CTE AS (
    SELECT log_id, 
            log_id - ROW_NUMBER() OVER(ORDER BY log_id) AS ROW_NUM_
    FROM Logs)

SELECT MIN(log_id) AS start_id,
       MAX(log_id) AS end_id
FROM CTE
GROUP BY ROW_NUM_
```

## ğŸŸ¢ í’€ì´ (Discription)

êµ¬í˜„í•˜ëŠ” ì¿¼ë¦¬ëŠ” ê°„ë‹¨í•œë°, ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë¡œì§ì„ ë– ì˜¬ë¦¬ê¸°ê°€ ì¢€ í˜ë“¤ì—ˆìŠµë‹ˆë‹¤.  
ë¬¸ì œì—ì„œ ì•„ë˜ ë‘ê°€ì§€ ì¡°ê±´ìœ¼ë¡œ ì—¬ëŸ¬ ê°€ì§€ ì ‘ê·¼ì„ ì‚¬ìš©í•´ë´¤ìŠµë‹ˆë‹¤.  

* ì—°ì†ë˜ì–´ ìˆëŠ” Rangeì˜ ê°€ì¥ ì‘ì€ ê°’, í° ê°’ì„ êµ¬í•˜ë©´ ì‹œì‘, ë ê°’ ì´ë‹¤.  
* ì—°ì†ë˜ì–´ ìˆëŠ” Rangeì˜ ë²”ìœ„ë¥¼ í•„í„°ë§í•˜ë ¤ë©´, ì–´ë–¤ ê¸°ì¤€ ìˆ«ìì—ì„œ ë”í•˜ê±°ë‚˜ ë¹¼ì•¼ í•œë‹¤.


#### STEP. 1 [Row_numberë¥¼ ì‚¬ìš©í•´ì„œ Range êµ¬í•˜ê¸°]

```sql
SELECT log_id, 
        ROW_NUMBER() OVER(ORDER BY log_id) AS ROW_NUM_INT,
        log_id - ROW_NUMBER() OVER(ORDER BY log_id) AS subtraction
FROM Logs
```

| log_id | ROW_NUM_INT | subtraction |
| ------ | ----------- | ----------- |
| 1      | 1           | 0           |
| 2      | 2           | 0           |
| 3      | 3           | 0           |
| 7      | 4           | 3           |
| 8      | 5           | 3           |
| 10     | 6           | 4           |

sqlì€ ì´í•´ë¥¼ ë•ê¸° ìœ„í•´, í•„ìš” ì—†ëŠ” ì»¬ëŸ¼ê¹Œì§€ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.  
ìœ„ì™€ ê°™ì´ `row_number()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ `log_id`ë¥¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•œ row numì„ êµ¬í•˜ê²Œ ë˜ë©´ 1~6ê¹Œì§€ì˜ ë²”ìœ„ê°€ ìƒì„±ë©ë‹ˆë‹¤.  
ì´ë ‡ê²Œ ì¶œë ¥í•˜ë©´ ê·œì¹™ì´ í•˜ë‚˜ ë³´ì´ê²Œ ë˜ëŠ”ë°, log_id ê°€ ì—°ì†ë˜ê²Œ ëœë‹¤ë©´, `+1` ì”© ì¦ê°€í•˜ê³ , row_number ë„ ë™ì¼í•˜ë‹¤ëŠ” ê²ƒ ì…ë‹ˆë‹¤.  

* ê·¸ë ‡ë‹¤ë©´ log_id - row_number = 0 ì´ë¼ë©´, ê°™ì€ Range ë²”ìœ„ ì•ˆì— ìˆë‹¤ê³  í•„í„°ë§ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  

<br/>

#### STEP. 2 [GROUP BY]

```sql
SELECT MIN(log_id) AS start_id,
       MAX(log_id) AS end_id
FROM CTE
GROUP BY log_id - row_numer
```

ì €ì˜ ê²½ìš°ì—ëŠ” `subtraction` ì»¬ëŸ¼ ìì²´ë¥¼ ì´ë¯¸, ì§‘ê³„í•œ ê²°ê³¼ë¥¼ ë„£ì–´ì„œ ë§Œë“¤ì—ˆì§€ë§Œ.  
ìœ„ì™€ ê°™ì´ subtractionì„ í¬í•¨í•œ Group byë¡œë„ êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
