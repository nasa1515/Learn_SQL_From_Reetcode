## [578. Get Highest Answer Rate Question]  


### Table: SurveyLog


| Column Name | Type |
|-------------|------|
| id          | int  |
| action      | ENUM |
| question_id | int  |
| answer_id   | int  |
| q_num       | int  |
| timestamp   | int  |

This table may contain duplicate rows.  
action is an ENUM (category) of the type: "show", "answer", or "skip".  
Each row of this table indicates the user with ID = id has taken an action with the question question_id at time timestamp.  
If the action taken by the user is "answer", answer_id will contain the id of that answer, otherwise, it will be null.  
q_num is the numeral order of the question in the current session.  
 
## Problem 

The answer rate for a question is the number of times a user answered the question by the number of times a user showed the question.  

Write a solution to report the question that has the highest answer rate. If multiple questions have the same maximum answer rate, report the question with the smallest question_id.  

The result format is in the following example.  

 

## Example 1:

### Input:   

SurveyLog table:  


| id | action | question_id | answer_id | q_num | timestamp |
|----|--------|-------------|-----------|-------|-----------|
| 5  | show   | 285         | null      | 1     | 123       |
| 5  | answer | 285         | 124124    | 1     | 124       |
| 5  | show   | 369         | null      | 2     | 125       |
| 5  | skip   | 369         | null      | 2     | 126       |

### Output: 

| survey_log |
|------------|
| 285        |

### Explanation: 
* Question 285 was showed 1 time and answered 1 time. The answer rate of question 285 is 1.0
* Question 369 was showed 1 time and was not answered. The answer rate of question 369 is 0.0
* Question 285 has the highest answer rate.



<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
SELECT question_id as survey_log
FROM SurveyLog
GROUP BY 1
ORDER BY ( count(answer_id) / SUM(IF(action="show",1,0)) ) DESC, question_id ASC
LIMIT 1
```

## ğŸŸ¢ í’€ì´ (Discription). 

ë¬¸ì œë¥¼ ìš”ì•½í•˜ë©´, `question_id`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ë‹µë¥  = action ê°’ì— ë¹„í•´ì„œ, `answer_id`ê°€ `Not Null`ì¸ ë¹„ìœ¨ì„ êµ¬í•˜ë©´ ì •ë‹µì…ë‹ˆë‹¤.  

1. `GROUP BY 1`ë¡œ `question_id`ì„ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ì–´ì„œ ì§‘ê³„í•©ë‹ˆë‹¤.  
2. `answer_id`ì— ìˆ«ìê°€ ìˆìœ¼ë©´, ì¦‰ not null ì¼ ê²½ìš°, ì‚¬ìš©ìëŠ” ì‘ë‹µì„ í•œ ê²½ìš°ë¡œ íŒë‹¨í•©ë‹ˆë‹¤. ì¦‰ `count(answer_id)` í•¨ìˆ˜ë¡œ nullì„ ì œì™¸í•œ ê°œìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.  
3. `action` ê°€ `show` ì¸ ê²½ìš°ì˜ ê°œìˆ˜ë¥¼ ê³„ì‚°í•´ì•¼í•¨ìœ¼ë¡œ, `if` ì ˆë¡œ ê°œìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.   
4. ìµœì¢…ì ìœ¼ë¡œ ì‘ë‹µë¥ ì„ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬, ë™ì¼í•œ ê°’ì´ ìˆë‹¤ë©´, question_id ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.  

% ì—¬ê¸°ì„œ í¬ì¸íŠ¸ëŠ” `count()` ì˜ ê²½ìš° Null ê°’ì„ ì œì™¸í•œ ì¸ìì˜ ê°œìˆ˜ë§Œ ì„¼ë‹¤ëŠ” ê²ƒ ì…ë‹ˆë‹¤.