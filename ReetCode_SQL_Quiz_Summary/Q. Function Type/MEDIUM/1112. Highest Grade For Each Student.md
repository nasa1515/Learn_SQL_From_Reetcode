## [1112. Highest Grade For Each Student]


### Table: Enrollments


| Column Name   | Type    |
|---------------|---------|
| student_id    | int     |
| course_id     | int     |
| grade         | int     |

(student_id, course_id) is the primary key (combination of columns with unique values) of this table.  
grade is never NULL.  
 
## Problem 

Write a solution to find the highest grade with its corresponding course for each student. In case of a tie, you should find the course with the smallest course_id.  

Return the result table ordered by student_id in ascending order.  

The result format is in the following example.  

 

## Example 1:

### Input:   

Enrollments table:  

| student_id | course_id | grade |
|------------|-----------|-------|
| 2          | 2         | 95    |
| 2          | 3         | 95    |
| 1          | 1         | 90    |
| 1          | 2         | 99    |
| 3          | 1         | 80    |
| 3          | 2         | 75    |
| 3          | 3         | 82    |

### Output: 

| student_id | course_id | grade |
|------------|-----------|-------|
| 1          | 2         | 99    |
| 2          | 2         | 95    |
| 3          | 3         | 82    |



<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
SELECT student_id, course_id, grade 
FROM 
    (SELECT *,
        DENSE_RANK() OVER(PARTITION BY student_id ORDER BY grade DESC, course_id ASC) as grade_rank
    FROM Enrollments) T
WHERE grade_rank = 1
```

## ğŸŸ¢ í’€ì´ (Discription)
`DENSE_RANK()`í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ `grade` ì»¬ëŸ¼ ê°’ì˜ rankingì„ ë§¤ê¸°ëŠ” ë¡œì§ìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.   
ë¬¸ì œì—ì„œ ë‚˜ì˜¨ ì¡°ê±´ì— ë”°ë¼ì„œ, í’€ì´ë¥¼ ëŒ€ì‹ í•˜ê² ìŠµë‹ˆë‹¤. 

1. `Enrollments` ë‹¨ì¼ í…Œì´ë¸”ì˜ ê° `student_id`ì˜ ê°€ì¥ ë†’ì€ `rank` ê°’ì„ ê°€ì§€ê³  ìˆëŠ” `course_id`ë¥¼ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.   
2. ë‹¨ìˆœí•˜ê²Œ ë‹¨ì¼ ì¿¼ë¦¬ë¡œëŠ” ë¶ˆê°€ëŠ¥í•˜ê³ , `CTE`ë‚˜ `Window`ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë°, ì €ëŠ” `Window`ê°€ í¸í•´ì„œ ìœ„ì™€ ê°™ì´ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.  
    * ë¬¸ì œì— ë‚˜ì˜¨ Partition by, Order By ì¡°ê±´ì„ ëª¨ë‘ ì ìš©í•œ Rankingì˜ ê°’ì´ 1ì¸ ê²ƒë§Œ ì¶œë ¥í•˜ë©´ ì •ë‹µì…ë‹ˆë‹¤.

### Ranking Window SQL 

```sql
SELECT *,
        DENSE_RANK() OVER(PARTITION BY student_id ORDER BY grade DESC, course_id ASC) as grade_rank
    FROM Enrollments
```

### Ranking Window SQL ê²°ê³¼ 

| student_id | course_id | grade | grade_rank |
| ---------- | --------- | ----- | ---------- |
| 1          | 2         | 99    | 1          |
| 1          | 1         | 90    | 2          |
| 2          | 2         | 95    | 1          |
| 2          | 3         | 95    | 2          |
| 3          | 3         | 82    | 1          |
| 3          | 1         | 80    | 2          |
| 3          | 2         | 75    | 3          |