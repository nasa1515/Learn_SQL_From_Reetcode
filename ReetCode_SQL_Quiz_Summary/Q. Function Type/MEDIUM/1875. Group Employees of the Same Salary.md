## [1875. Group Employees of the Same Salary]  

### Table: Employees


| Column Name | Type    |
|-------------|---------|
| employee_id | int     |
| name        | varchar |
| salary      | int     |

employee_id is the column with unique values for this table.  
Each row of this table indicates the employee ID, employee name, and salary.  
 
## Problem

A company wants to divide the employees into teams such that all the members on each team have the same salary. The teams should follow these criteria:

* Each team should consist of at least two employees.
* All the employees on a team should have the same salary.
* All the employees of the same salary should be assigned to the same team.
* If the salary of an employee is unique, we do not assign this employee to any team.
* A team's ID is assigned based on the rank of the team's salary relative to the other teams' salaries, where the team with the lowest salary has team_id = 1. Note that the salaries for employees not on a team are not included in this ranking.  


Write a solution to get the team_id of each employee that is in a team.  

Return the result table ordered by team_id in ascending order. In case of a tie, order it by employee_id in ascending order.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Employees table:

| employee_id | name    | salary |
|-------------|---------|--------|
| 2           | Meir    | 3000   |
| 3           | Michael | 3000   |
| 7           | Addilyn | 7400   |
| 8           | Juan    | 6100   |
| 9           | Kannon  | 7400   |

### Output: 

| employee_id | name    | salary | team_id |
|-------------|---------|--------|---------|
| 2           | Meir    | 3000   | 1       |
| 3           | Michael | 3000   | 1       |
| 7           | Addilyn | 7400   | 2       |
| 9           | Kannon  | 7400   | 2       |

### xplanation: 

* Meir (employee_id=2) and Michael (employee_id=3) are in the same team because they have the same salary of 3000.
* Addilyn (employee_id=7) and Kannon (employee_id=9) are in the same team because they have the same salary of 7400.
* Juan (employee_id=8) is not included in any team because their salary of 6100 is unique (i.e. no other employee has the same salary).

* The team IDs are assigned as follows (based on salary ranking, lowest first):
    - team_id=1: Meir and Michael, a salary of 3000
    - team_id=2: Addilyn and Kannon, a salary of 7400

* Juan's salary of 6100 is not included in the ranking because they are not on a team.  



---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
SELECT E1.employee_id, E1.name, E1.salary,
       DENSE_RANK() OVER(ORDER BY E1.salary ASC) AS team_id
FROM Employees E1, Employees E2
WHERE E1.employee_id != E2.employee_id AND E1.salary = E2.salary
GROUP BY employee_id
ORDER BY team_id, employee_id
```

## ğŸŸ¢ í’€ì´ (Discription)
  
ë¬¸ì œì—ì„œ ë„ì¶œë˜ëŠ” íŒíŠ¸ë“¤ì„ ì¢…í•©í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì¡°ê±´ë“¤ì„ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

* ë¬¸ì œëŠ” ë‹¤ë¥¸ `employee_id`ë¥¼ ê°€ì§„ ì‚¬ëŒ ì¤‘ì— ë™ì¼í•œ `salary` ê°’ì„ ê°€ì§„ ì‚¬ëŒë“¤ì„ í•˜ë‚˜ì˜ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ì–´ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.  
* ì¶œë ¥ì˜ ê²°ê³¼ì—ì„œëŠ” `salary` ê°’ì´ ë‚®ì„ ìˆ˜ë¡ ë‚®ì€ ìˆ«ìì˜ `Team_id`ë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.

<br/>



#### STEP. 1 [SELF JOIN]  

```sql
SELECT *
FROM Employees E1, Employees E2
WHERE E1.employee_id != E2.employee_id AND E1.salary = E2.salary
```

| employee_id | name    | salary | employee_id | name    | salary |
| ----------- | ------- | ------ | ----------- | ------- | ------ |
| 3           | Michael | 3000   | 2           | Meir    | 3000   |
| 2           | Meir    | 3000   | 3           | Michael | 3000   |
| 9           | Kannon  | 7400   | 7           | Addilyn | 7400   |
| 7           | Addilyn | 7400   | 9           | Kannon  | 7400   |  

ë™ì¼í•œ ë°ì´í„°ë¥¼ í•„í„°ë§ í•œ ë’¤ ì§‘ê³„í•´ì•¼í•˜ê¸°ì—, `SELF JOIN`ìœ¼ë¡œ ë™ì¼í•œ `salary`ì™€ ë‹¤ë¥¸ `Employee_id`ë¥¼ ê°€ì§„ ì¡°ê±´ì„ ë„£ì–´ í•„í„°ë§í–ˆìŠµë‹ˆë‹¤.  

<br/>


#### STEP. 2 [Group by - Rank()]  

```sql
SELECT E1.employee_id, E1.name, E1.salary,
       DENSE_RANK() OVER(ORDER BY E1.salary ASC) AS team_id
FROM Employees E1, Employees E2
WHERE E1.employee_id != E2.employee_id AND E1.salary = E2.salary
GROUP BY employee_id
ORDER BY team_id, employee_id
```  

| employee_id | name    | salary | team_id |
| ----------- | ------- | ------ | ------- |
| 2           | Meir    | 3000   | 1       |
| 3           | Michael | 3000   | 1       |
| 7           | Addilyn | 7400   | 2       |
| 9           | Kannon  | 7400   | 2       |

ë‹¨ìˆœí•˜ê²Œ, `Self Join`ìœ¼ë¡œ ì§‘ê³„ëœ ë°ì´í„°ì—ì„œ,`employee_id`ë¡œ Group Byë¥¼ í•œ ë’¤,  
`salary` ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ `Dense_rank` í•¨ìˆ˜ë¡œ Team_id  ìƒì„±í•œ ë’¤ ì¶œë ¥í•©ë‹ˆë‹¤.