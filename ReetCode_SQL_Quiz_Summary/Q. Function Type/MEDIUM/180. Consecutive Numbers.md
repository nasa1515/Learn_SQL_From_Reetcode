## [180. Consecutive Numbers]


### Table: Logs


| Column Name | Type    |
|-------------|---------|
| id          | int     |
| num         | varchar |

In SQL, id is the primary key for this table.  
id is an autoincrement column.  
 
## Problem 

Find all numbers that appear at least three times consecutively.  

Return the result table in any order.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Logs table:


| id | num |
|----|-----|
| 1  | 1   |
| 2  | 1   |
| 3  | 1   |
| 4  | 2   |
| 5  | 1   |
| 6  | 2   |
| 7  | 2   |

### Output: 

| ConsecutiveNums |
|-----------------|
| 1               |

### Explanation: 
* 1 is the only number that appears consecutively for at least three times.


<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
WITH number_temp as (SELECT 
        LAG(id) OVER (ORDER BY id) AS prev_id,
        id,
        LEAD(id) OVER (ORDER BY id) AS next_id,
        LAG(num) OVER (ORDER BY id) AS prev_num,
        num,
        LEAD(num) OVER (ORDER BY id) AS next_num
FROM logs)

SELECT DISTINCT(num) AS ConsecutiveNums 
FROM number_temp
WHERE prev_num = num AND num = next_num
AND next_id - id = 1 AND id - prev_id = 1
```

## ğŸŸ¢ í’€ì´ (Discription)
`WITH ì ˆ`ì„ ì‚¬ìš©í•´ `LAG, LEAD` í•¨ìˆ˜ë¡œ, ê°ê° ë‹¤ìŒ, ì´ì „ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆëŠ” TEMP í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì„œ í•„í„°ë§í•´ì„œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ í•´ê²°í–ˆìŠµë‹ˆë‹¤.   
ë¬¸ì œì—ì„œ ë‚˜ì˜¨ ì¡°ê±´ì— ë”°ë¼ì„œ, í’€ì´ë¥¼ ëŒ€ì‹ í•˜ê² ìŠµë‹ˆë‹¤. 

* ë¬¸ì œ ìš”ê±´ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€, `ìµœì†Œ 3ë²ˆ ì´ìƒ ì—°ì†`ëœ ì»¬ëŸ¼ì´ ë™ì¼í•œ ìˆ«ìì¼ ê²½ìš°ì— ê·¸ `number` ê°’ì„ ê°€ì ¸ ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤. 

1. `number_temp`ë¼ê³  í•˜ëŠ” `id` ê¸°ì¤€ê³¼, `num` ê¸°ì¤€ì˜ ì´ì „, ë‹¤ìŒ ê°’ì„ ê°€ì§€ê³  ìˆëŠ” TEMP Tableì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. 

| prev_id | id | next_id | prev_num | num | next_num |
| ------- | -- | ------- | -------- | --- | -------- |
| null    | 1  | 2       | null     | 1   | 1        |
| 1       | 2  | 3       | 1        | 1   | 1        |
| 2       | 3  | 4       | 1        | 1   | 2        |
| 3       | 4  | 5       | 1        | 2   | 1        |
| 4       | 5  | 6       | 2        | 1   | 2        |
| 5       | 6  | 7       | 1        | 2   | 2        |
| 6       | 7  | null    | 2        | 2   | null     |  

ì´ í…Œì´ë¸”ì—ì„œ `ì—°ì†ëœ`ì´ë¼ëŠ” ì¡°ê±´ì— ì•Œë§ê²Œ í•„í„°ë§ í•˜ë©´ ë˜ëŠ”ë°, ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
* `1-2-3` ê³¼ ê°™ì´ ì—°ì†ë˜ì–´ ìˆëŠ” `id`ì˜ í•„í„°ë§ `next_id - id = 1 AND id - prev_id = 1`ê³¼ ê°™ì´ ì„¸ ê°’ì´ ê°™ì€ ê²½ìš°
* `1-1-1` ê³¼ ê°™ì´ ë™ì¼í•œ `num` ê°’ì˜ í•„í„°ë§ `prev_num = num AND num = next_num`ê³¼ ê°™ì´ ì„¸ ê°’ì´ ê°™ì€ ê²½ìš°.



## ğŸŸ¢ SELF JOINìœ¼ë¡œ í‘¸ëŠ” ë‹µì•ˆ (SQL Solution)

```sql
SELECT DISTINCT(L1.num) AS ConsecutiveNums
FROM Logs L1, 
     Logs L2, 
     Logs L3
WHERE L1.id = L2.id - 1 AND L2.id = L3.id - 1
AND L1.num = L2.num AND L1.num = L3.num
```
ìœ„ì— `LAG, LEAD` í•¨ìˆ˜ë¡œ í’€ì—ˆë˜ ë¬¸ì œë¥¼ ì •ë¦¬í•˜ë˜ ì™€ì¤‘ì—, ì´ê±° `SELF JOIN`ìœ¼ë¡œë„ ì¶©ë¶„íˆ ê°€ëŠ¥í•  ê²ƒ ê°™ì€ë°?  
ë¼ëŠ” ìƒê°ì´ ë“¤ì–´ì„œ í’€ì–´ë´¤ëŠ”ë°, í’€ë ¸ìŠµë‹ˆë‹¤. ì²«ë²ˆì§¸ í’€ì´ì™€ ê°™ì´, `WHERE` ì¡°ê±´ë„ ë™ì¼í•©ë‹ˆë‹¤.