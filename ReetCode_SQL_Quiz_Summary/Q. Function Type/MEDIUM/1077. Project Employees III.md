## [1077. Project Employees III]

### Table: Project


| Column Name | Type    |
|-------------|---------|
| project_id  | int     |
| employee_id | int     |

(project_id, employee_id) is the primary key (combination of columns with unique values) of this table.  
employee_id is a foreign key (reference column) to Employee table.  
Each row of this table indicates that the employee with employee_id is working on the project with project_id.  
 

### Table: Employee


| Column Name      | Type    |
|------------------|---------|
| employee_id      | int     |
| name             | varchar |
| experience_years | int     |

employee_id is the primary key (column with unique values) of this table.  
Each row of this table contains information about one employee.  
 
## Problem 

Write a solution to report the most experienced employees in each project. In case of a tie, report all employees with the maximum number of experience years.  

Return the result table in any order.  

The result format is in the following example.   

 

## Example 1:

### Input: 

Project table:

| project_id  | employee_id |
|-------------|-------------|
| 1           | 1           |
| 1           | 2           |
| 1           | 3           |
| 2           | 1           |
| 2           | 4           |

Employee table:

| employee_id | name   | experience_years |
|-------------|--------|------------------|
| 1           | Khaled | 3                |
| 2           | Ali    | 2                |
| 3           | John   | 3                |
| 4           | Doe    | 2                |

### Output: 

| project_id  | employee_id   |
|-------------|---------------|
| 1           | 1             |
| 1           | 3             |
| 2           | 1             |

### Explanation: 
* Both employees with id 1 and 3 have the most experience among the employees of the first project. For the second project, the employee with id 1 has the most experience.




<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
WITH CTE_RANK AS (
    SELECT P1.project_id, P1.employee_id,
        DENSE_RANK() OVER(PARTITION BY P1.project_id ORDER BY E1.experience_years DESC) AS ranking
    FROM Project P1
    JOIN Employee E1
    ON P1.employee_id = E1.employee_id)

SELECT project_id, employee_id
FROM CTE_RANK
WHERE ranking = 1
```

## ğŸŸ¢ í’€ì´ (Discription)
`DENSE_RANK()`í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ `experience_years` ì»¬ëŸ¼ ê°’ì˜ rankingì„ ë§¤ê¸°ëŠ” ë¡œì§ìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.   
ë¬¸ì œì—ì„œ ë‚˜ì˜¨ ì¡°ê±´ì— ë”°ë¼ì„œ, í’€ì´ë¥¼ ëŒ€ì‹ í•˜ê² ìŠµë‹ˆë‹¤. 

1. `experience_years`ì˜ ì ìˆ˜ì— ë”°ë¼ì„œ, `RANK`ë¥¼ ë§¤ê¸°ëŠ” í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì¶œë ¥í•´ì•¼ í•©ë‹ˆë‹¤.  
ë‹¤ë§Œ ë¬¸ì œì˜ ì¡°ê±´ì—, `ë™ì¼í•œ ì ìˆ˜ì¸ ê²½ìš°` ë™ì¼í•œ Rank ê°’ì„ ê³µìœ í•˜ê³ , ë‹¤ìŒ ë­í‚¹ ê°’ì„ ê±´ë„ˆë›°ì§€ ì•Šì•„ì•¼ í•˜ëŠ”ë°, `Rank` í•¨ìˆ˜ì˜ ê²½ìš° ê±´ë„ˆë›°ê²Œ ë©ë‹ˆë‹¤.    

2. ë”°ë¼ì„œ `Window Function`ì˜ `Partition By` ê¸°ì¤€ ì»¬ëŸ¼ì„ `project_id`ìœ¼ë¡œ ì¡ì€ ë’¤, Rankingì„ ë§¤ê¸´ ì»¬ëŸ¼ì˜ ê°’ì´ 1ì¸ ê°’ë§Œ ì¶œë ¥í•˜ë©´ ì •ë‹µì…ë‹ˆë‹¤.