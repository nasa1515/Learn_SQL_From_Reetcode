## [618. Students Report By Geography]  


### Table: Student

| Column Name | Type    |
|-------------|---------|
| name        | varchar |
| continent   | varchar |

This table may contain duplicate rows.  
Each row of this table indicates the name of a student and the continent they came from.  
 
## Problem 

A school has students from Asia, Europe, and America.  

Write a solution to pivot the continent column in the Student table so that each name is sorted alphabetically and displayed underneath its corresponding continent. The output headers should be America, Asia, and Europe, respectively.  

The test cases are generated so that the student number from America is not less than either Asia or Europe.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Student table:

| name   | continent |
|--------|-----------|
| Jane   | America   |
| Pascal | Europe    |
| Xi     | Asia      |
| Jack   | America   |

### Output: 

| America | Asia | Europe |
|---------|------|--------|
| Jack    | Xi   | Pascal |
| Jane    | null | null   |

 

* Follow up: If it is unknown which continent has the most students, could you write a solution to generate the student report?



<br/>

---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
SELECT
    MAX(CASE WHEN continent = 'America' THEN name ELSE NULL END) AS America,
    MAX(CASE WHEN continent = 'Asia' THEN name ELSE NULL END) AS Asia,
    MAX(CASE WHEN continent = 'Europe' THEN name ELSE NULL END) AS Europe
FROM 
    (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY continent ORDER BY name) AS continent_row_id 
    FROM student
    ) T1
GROUP BY continent_row_id
ORDER BY continent_row_id
```

## ğŸŸ¢ í’€ì´ (Discription)

mysqlì—ëŠ” `Pivot` Functionì´ ë”°ë¡œ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `Window`ë¡œ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.  
ë¬¸ì œì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì¡°ê±´ì„ ê¸°ì¤€ìœ¼ë¡œ, í’€ì´ë¥¼ ë‚˜ì—´í•´ë³´ê² ìŠµë‹ˆë‹¤.  

* Student tableì˜ `continent` ì»¬ëŸ¼ì˜ Distinct í•œ ë‚˜ë¼ ì´ë¦„ì„ Columns ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ Pivoting í•©ë‹ˆë‹¤.  
* `America` ì—ëŠ” ì¤‘ë³µëœ í•™ìƒ ì´ë¦„ì´ ìˆìŠµë‹ˆë‹¤.  

<br/>

#### STEP. 1 [ROW_NUMBER()ë¡œ ì¤‘ë³µ í•™ìƒ êµ¬ë¶„í•˜ê¸°]  

```sql
SELECT *,
       ROW_NUMBER() OVER(PARTITION BY continent ORDER BY name) AS continent_row_id
FROM Student
```

| name   | continent | continent_row_id |
| ------ | --------- | ---------------- |
| Jack   | America   | 1                |
| Jane   | America   | 2                |
| Xi     | Asia      | 1                |
| Pascal | Europe    | 1                |  

`ROW_NUMBER`ë¥¼ ì‚¬ìš©í•´ì„œ, `continent` ë³„ë¡œ ìˆ«ìë¥¼ ê³„ì‚°í•˜ë©´, ìœ„ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.    
ì´ì™€ ê°™ì´ í–‰ìœ¼ë¡œ ë‚˜ëˆˆ ì´ìœ ëŠ”, `CASE WHEN`ìœ¼ë¡œ ê° `continent` ë³„ë¡œ ë°ì´í„°ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.  

<br/>

---

#### STEP. 2 [CASE WHEN ì§‘ê³„]

```sql
SELECT continent_row_id,
    CASE WHEN continent = 'America' THEN name ELSE NULL END AS America,
    CASE WHEN continent = 'Asia' THEN name ELSE NULL END AS Asia,
    CASE WHEN continent = 'Europe' THEN name ELSE NULL END AS Europe
FROM 
    (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY continent ORDER BY name) AS continent_row_id 
    FROM student
    ) T1
```

| continent_row_id | America | Asia | Europe |
| ---------------- | ------- | ---- | ------ |
| 1                | Jack    | null | null   |
| 2                | Jane    | null | null   |
| 1                | null    | Xi   | null   |
| 1                | null    | null | Pascal |  

ì§‘ê³„ê²°ê³¼ë¥¼ ë³´ë©´, ` America | Asia | Europe` ê° ë‚˜ë¼ ë³„ë¡œ `ë¬¸ì ì™€ null` êµ¬ë¶„ ë°ì´í„°ê°€ ì˜ ë“¤ì–´ê°„ ê²ƒì´ ë³´ì´ê³ ,   
`continent_row_id` ê¸°ì¤€ìœ¼ë¡œ GROUP BYë¥¼ í•˜ë©´ ê²°ê³¼ê°€ ì§‘ê³„ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.   

<br/>

---

#### âŒ STEP. 3 [GROUP BY ì§‘ê³„]

```sql
SELECT 
    CASE WHEN continent = 'America' THEN name ELSE NULL END AS America,
    CASE WHEN continent = 'Asia' THEN name ELSE NULL END AS Asia,
    CASE WHEN continent = 'Europe' THEN name ELSE NULL END AS Europe
FROM 
    (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY continent ORDER BY name) AS continent_row_id 
    FROM student
    ) T1
GROUP BY continent_row_id
```

| America | Asia | Europe |
| ------- | ---- | ------ |
| Jack    | null | null   |
| Jane    | null | null   |  

ë‹¨ìˆœí•˜ê²Œ `continent_row_id`ë¡œë§Œ GROUP BY ì§‘ê³„ë¥¼ í•˜ë©´, ë‹¤ìŒê³¼ ê°™ì´ `CASW WHEN` ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì•ˆë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.    
ì´ìœ ëŠ”, GROUP BY ì§‘ê³„ì—ì„œ `continent_row_id = 1` ì¸ ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ë°ì´í„°ê°€ ì§‘ê³„ë©ë‹ˆë‹¤.  

| continent_row_id | America | Asia | Europe |
| ---------------- | ------- | ---- | ------ |
| 1                | Jack    | null | null   |
| 1                | null    | Xi   | null   |
| 1                | null    | null | Pascal |    

ê·¸ëŸ¬ë‚˜, GROUP BY ì§‘ê³„ ë°ì´í„°ëŠ” `continent_row_id = 1` ê·¸ë£¹ì—ì„œ `America` ì»¬ëŸ¼ì— ì¡´ì¬í•˜ëŠ” `jack, null, null` ì„¸ê°œì˜ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì¶œë ¥í•´ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.  
ë”°ë¡œ `Aggregation` í•¨ìˆ˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. (ì—¬ëŸ¬ ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì— ë§ì´ì£ ), ê·¸ë ‡ë‹¤ë©´ ìœ„ì™€ ê°™ì€ ë°ì´í„°ì—ì„œ ë¬¸ì œì—ì„œ ìš”êµ¬í•˜ëŠ” ê²ƒì„ ì¶œë ¥í•˜ê¸° ìœ„í•´ì„œëŠ” íŠ¹ì • group ë³„ë¡œ nullì„ ì œê±°í•˜ë©´ ë©ë‹ˆë‹¤.  
ì´ ê²½ìš° `max()` í•¨ìˆ˜ì—ì„œëŠ” null ê°’ì„ ì œì™¸í•˜ê³  ê°€ì¥ í° ê°’ì„ ë°˜í™˜í•´ì£¼ë‹ˆ, ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.  

<br/>

---

#### ğŸŸ¢ STEP. 3 [GROUP BY - MAX ì§‘ê³„]

```sql
SELECT 
    MAX(CASE WHEN continent = 'America' THEN name ELSE NULL END) AS America,
    MAX(CASE WHEN continent = 'Asia' THEN name ELSE NULL END) AS Asia,
    MAX(CASE WHEN continent = 'Europe' THEN name ELSE NULL END) AS Europe
FROM 
    (
    SELECT *, 
        ROW_NUMBER() OVER(PARTITION BY continent ORDER BY name) AS continent_row_id 
    FROM student
    ) T1
GROUP BY continent_row_id
```

| America | Asia | Europe |
| ------- | ---- | ------ |
| Jack    | Xi   | Pascal |
| Jane    | null | null   |  

ìœ„ì™€ ê°™ì´ `MAX()`, `MIN()`ë“±, GROUP BY ì§‘ê³„ì—ì„œ íŠ¹ì •í•˜ê²Œ í•˜ë‚˜ì˜ ë°ì´í„° ì¸ìë§Œ ë½‘ì•„ë‚¼ ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì •ë‹µì´ ì¶œë ¥ë©ë‹ˆë‹¤.  
