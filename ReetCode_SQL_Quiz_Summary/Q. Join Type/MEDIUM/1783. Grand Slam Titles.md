## [1783. Grand Slam Titles]  


### Table: Players


| Column Name    | Type    |
|----------------|---------|
| player_id      | int     |
| player_name    | varchar |

player_id is the primary key (column with unique values) for this table.  
Each row in this table contains the name and the ID of a tennis player.  
 

### Table: Championships


| Column Name   | Type    |
|---------------|---------|
| year          | int     |
| Wimbledon     | int     |
| Fr_open       | int     |
| US_open       | int     |
| Au_open       | int     |

year is the primary key (column with unique values) for this table.  
Each row of this table contains the IDs of the players who won one each tennis tournament of the grand slam.  
 
## Problem  

Write a solution to report the number of grand slam tournaments won by each player. Do not include the players who did not win any tournament.  

Return the result table in any order.  

The result format is in the following example.  

 

## Example 1:

### Input: 

Players table:

| player_id | player_name |
|-----------|-------------|
| 1         | Nadal       |
| 2         | Federer     |
| 3         | Novak       |

Championships table:

| year | Wimbledon | Fr_open | US_open | Au_open |
|------|-----------|---------|---------|---------|
| 2018 | 1         | 1       | 1       | 1       |
| 2019 | 1         | 1       | 2       | 2       |
| 2020 | 2         | 1       | 2       | 2       |

### Output: 

| player_id | player_name | grand_slams_count |
|-----------|-------------|-------------------|
| 2         | Federer     | 5                 |
| 1         | Nadal       | 7                 |

### Explanation: 

* Player 1 (Nadal) won 7 titles: Wimbledon (2018, 2019), Fr_open (2018, 2019, 2020), US_open (2018), and Au_open (2018).
* Player 2 (Federer) won 5 titles: Wimbledon (2020), US_open (2019, 2020), and Au_open (2019, 2020).
* Player 3 (Novak) did not win anything, we did not include them in the result table.  


---

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>


## ğŸŸ¢ ë‹µì•ˆ (SQL Solution)

```sql
SELECT player_id, player_name, 
       SUM(Wimbledon = player_id) + SUM(Fr_open = player_id) + SUM(US_open = player_id) + SUM(Au_open = player_id) AS grand_slams_count
FROM Players P1
JOIN Championships C1
ON C1.Wimbledon = P1.player_id OR C1.Fr_open = P1.player_id OR C1.US_open = P1.player_id OR C1.Au_open = P1.player_id
GROUP BY player_id
ORDER BY 1 DESC
```

## ğŸŸ¢ í’€ì´ (Discription)

ë¬¸ì œì—ì„œ ë„ì¶œë˜ëŠ” íŒíŠ¸ë“¤ì„ ì¢…í•©í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì¡°ê±´ë“¤ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

* ë¬¸ì œì˜ ì¶œë ¥ ìš”ê±´ì€ `Championships` í…Œì´ë¸”ì— `player_id`ë¡œ ìš°ìŠ¹ìê°€ ëª…ì‹œë˜ì–´ ìˆëŠ”ë°, ê° ëŒ€íšŒ ë³„ ìš°ìŠ¹ìì˜ ìš°ìŠ¹íšŸìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.  
* `Championships` í…Œì´ë¸”ì—ëŠ” ì—¬ëŸ¬ ì»¬ëŸ¼ì— ì¤‘ë³µëœ í˜•íƒœì˜ Keyê°€ ë‚´í¬ë˜ì–´ ìˆì–´, OR ì ˆì˜ Joinì´ë‚˜, Unionìœ¼ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ì™€ì•¼ í•©ë‹ˆë‹¤.  
* `player_id` 3ë²ˆì˜ ê²½ìš° ìš°ìŠ¹íšŸìˆ˜ê°€ ì—†ìœ¼ë©´, ì¶œë ¥ë˜ì§€ ì•ŠëŠ” í˜•íƒœ.

<br/>



#### STEP. 1 [JOINìœ¼ë¡œ ë°ì´í„° ì»¬ëŸ¼ ì§‘ê³„í•˜ê¸°]  

```sql
SELECT *
FROM Players P1
JOIN Championships C1
ON C1.Wimbledon = P1.player_id OR C1.Fr_open = P1.player_id OR C1.US_open = P1.player_id OR C1.Au_open = P1.player_id
```

| player_id | player_name | year | Wimbledon | Fr_open | US_open | Au_open |
| --------- | ----------- | ---- | --------- | ------- | ------- | ------- |
| 1         | Nadal       | 2018 | 1         | 1       | 1       | 1       |
| 2         | Federer     | 2019 | 1         | 1       | 2       | 2       |
| 1         | Nadal       | 2019 | 1         | 1       | 2       | 2       |
| 2         | Federer     | 2020 | 2         | 1       | 2       | 2       |
| 1         | Nadal       | 2020 | 2         | 1       | 2       | 2       |  

ìš°ìŠ¹íšŸìˆ˜ê°€ ì—†ìœ¼ë©´ ì¶œë ¥ë˜ì§€ ì•ŠëŠ” í˜•íƒœë¼, Inner Joinìœ¼ë¡œ í’€ì´í•˜ì˜€ìŠµë‹ˆë‹¤.   

* ON C1.Wimbledon = P1.player_id OR C1.Fr_open = P1.player_id OR C1.US_open = P1.player_id OR C1.Au_open = P1.player_id // ê° ìš°ìŠ¹ìì˜ OR ì¡°ê±´   

<br/>


#### STEP. 2 [GROUP BY - SUM() ì§‘ê³„]  

```sql
SELECT player_id, player_name, 
       SUM(Wimbledon = player_id) + SUM(Fr_open = player_id) + SUM(US_open = player_id) + SUM(Au_open = player_id) AS grand_slams_count
FROM Players P1
JOIN Championships C1
ON C1.Wimbledon = P1.player_id OR C1.Fr_open = P1.player_id OR C1.US_open = P1.player_id OR C1.Au_open = P1.player_id
GROUP BY player_id
ORDER BY 1 DESC
```
 
| player_id | player_name | grand_slams_count |
| --------- | ----------- | ----------------- |
| 2         | Federer     | 5                 |
| 1         | Nadal       | 7                 |  

ë‹¤ìŒê³¼ ê°™ì´ Joinìœ¼ë¡œ ë¶™ì—¬ì„œ ì§‘ê³„í•œ ë°ì´í„°ë¥¼, `player_id`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ Grouping í›„, ê°ê° `player_id` ì¡°ê±´ì— ë§ëŠ” ê²½ìš°ë¥¼ í•©ì‚°í•˜ë©´ ì •ë‹µì…ë‹ˆë‹¤.  

